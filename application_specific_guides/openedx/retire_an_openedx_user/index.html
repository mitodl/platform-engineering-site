<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Retiring a User - Platform Engineering Documentation</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Platform Engineering Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Getting Started</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../getting_started/emergency-break-glass/" class="dropdown-item">Emergency Oncall Break Glass Procedure</a>
</li>
                                    
<li>
    <a href="../../../getting_started/developer_eks_access/" class="dropdown-item">Developer EKS Access</a>
</li>
                                    
<li>
    <a href="../../../getting_started/vault_access_for_developers/" class="dropdown-item">Vault Access for Developers</a>
</li>
                                    
<li>
    <a href="../../../getting_started/update_this_site/" class="dropdown-item">Updating This Site</a>
</li>
                                    
<li>
    <a href="../../../getting_started/pe-product-infra-map/" class="dropdown-item">Applications & Services</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Platform Services</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Secrets Management (Vault)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../platform_services/secrets_management/restore_vault_backups/" class="dropdown-item">Restoring Vault Backups</a>
</li>
            
<li>
    <a href="../../../platform_services/secrets_management/faking_it_with_consul_and_vault/" class="dropdown-item">Faking It with Consul and Vault</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Service Discovery (Consul)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../platform_services/service_discovery/consul_incantations/" class="dropdown-item">Consul Incantations</a>
</li>
            
<li>
    <a href="../../../platform_services/service_discovery/fargate_service_discovery/" class="dropdown-item">Fargate Service Discovery</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Container Orchestration (Kubernetes)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../platform_services/container_orchestration/deploying_apps_with_kubernetes/" class="dropdown-item">Deploying Apps with Kubernetes</a>
</li>
            
<li>
    <a href="../../../platform_services/container_orchestration/kubernetes_cookbook/" class="dropdown-item">Kubernetes Cookbook</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">CI/CD (Concourse)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../platform_services/ci_cd/getting_started_with_concourse/" class="dropdown-item">Getting Started with Concourse</a>
</li>
            
<li>
    <a href="../../../platform_services/ci_cd/deploying_concourse/" class="dropdown-item">Deploying Concourse</a>
</li>
            
<li>
    <a href="../../../platform_services/ci_cd/concourse_github_issues_user_guide/" class="dropdown-item">Concourse GitHub Issues User Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Cloud Infrastructure (AWS & Pulumi)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/pulumi_aws_classic_5_to_6_upgrade/" class="dropdown-item">Pulumi AWS Classic 5 to 6 Upgrade</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/import_existing_resources_with_pulumi/" class="dropdown-item">Importing Existing Resources with Pulumi</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/test_and_deploy_pulumi_packer_projects/" class="dropdown-item">Testing and Deploying Pulumi Packer Projects</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/tagging_amis_with_installed_software_metadata/" class="dropdown-item">Tagging AMIs with Software Metadata</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/moira_certificates/" class="dropdown-item">Moira Certificates</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/recaptcha/" class="dropdown-item">Recaptcha</a>
</li>
            
<li>
    <a href="../../../platform_services/cloud_infrastructure/publishing_to_npm/" class="dropdown-item">Publishing to NPM</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Application Specific Guides</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Open edX</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../prove_build_was_deployed/" class="dropdown-item">Proving Build Was Deployed</a>
</li>
            
<li>
    <a href="../access_django_manage/" class="dropdown-item">Accessing Django Manage</a>
</li>
            
<li>
    <a href="../enable_rapid_response_edxapp/" class="dropdown-item">Enabling Rapid Response edXApp</a>
</li>
            
<li>
    <a href="../mysql_access/" class="dropdown-item">MySQL Access</a>
</li>
            
<li>
    <a href="../retirement_pipeline/" class="dropdown-item">Retirement Pipeline</a>
</li>
            
<li>
    <a href="../release_upgrades/" class="dropdown-item">Release Upgrades</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Retiring a User</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Heroku (Legacy)</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../heroku_legacy/config_vars/" class="dropdown-item">Config Vars</a>
</li>
            
<li>
    <a href="../../heroku_legacy/dynosaur_management/" class="dropdown-item">Dynosaur Management</a>
</li>
            
<li>
    <a href="../../heroku_legacy/log_drains/" class="dropdown-item">Log Drains</a>
</li>
            
<li>
    <a href="../../heroku_legacy/transition_postgres_db_to_rds/" class="dropdown-item">Transitioning Postgres DB to RDS</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">OCW Studio</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../ocw-studio/Update_OCW_Studio_Pipeline/" class="dropdown-item">Updating The OCW Studio Pipeline</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Renovate</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../renovate/updating_renovate_config/" class="dropdown-item">Updating Renovate Configuration</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">JupyterHub</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../jupyterhub/jupyterhub_admin_guide/" class="dropdown-item">JupyterHub Admin Guide</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Monitoring And Observability</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../monitoring_observability/overview/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../../monitoring_observability/inventory/" class="dropdown-item">Inventory</a>
</li>
                                    
<li>
    <a href="../../../monitoring_observability/key_labels/" class="dropdown-item">Key Labels</a>
</li>
                                    
<li>
    <a href="../../../monitoring_observability/bump_sentry_credit/" class="dropdown-item">Bumping Sentry Credit</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Runbooks & Post-Mortems</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../runbooks_post_mortems/oncall_runbook/" class="dropdown-item">On-Call Runbook</a>
</li>
                                    
<li>
    <a href="../../../runbooks_post_mortems/20231030_xpro_outage/" class="dropdown-item">20231030 xPro Outage Post-Mortem</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Cookbooks & Patterns</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../cookbooks_patterns/devops_patterns_cookbook/" class="dropdown-item">DevOps Patterns Cookbook</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Partner Documentation</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../sso_onboarding/sso_config/" class="dropdown-item">Integrating With MIT Learn SSO</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../release_upgrades/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../heroku_legacy/config_vars/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item dropdown">
                              <button id="theme-menu" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme" class="nav-link dropdown-toggle">
                                <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                <span class="d-lg-none ms-2">Toggle theme</span>
                              </button>
                              <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="true">
                                    <i class="fa-solid fa-sun fa-fw"></i>
                                    <span class="ms-2">Light</span>
                                    <i class="fa-solid fa-check ms-auto"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                                    <i class="fa-solid fa-moon fa-fw"></i>
                                    <span class="ms-2">Dark</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                                <li>
                                  <button class="dropdown-item d-flex align-items-center" data-bs-theme-value="auto" aria-pressed="false">
                                    <i class="fa-solid fa-circle-half-stroke fa-fw"></i>
                                    <span class="ms-2">Auto</span>
                                    <i class="fa-solid fa-check ms-auto d-none"></i>
                                  </button>
                                </li>
                              </ul>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
        <script src="../../../js/darkmode.js"></script>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#how-to-retire-an-mit-online-learning-openedx-user" class="nav-link">How To Retire An MIT Online Learning OpenEdX User</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#pre-requisites" class="nav-link">Pre-Requisites</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#look-up-this-users-username" class="nav-link">Look Up This User's username</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#get-yourself-connected" class="nav-link">Get Yourself Connected</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#prepare-your-environment" class="nav-link">Prepare Your Environment</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#get-to-the-retiring-already" class="nav-link">Get To The Retiring Already!</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="how-to-retire-an-mit-online-learning-openedx-user">How To Retire An MIT Online Learning OpenEdX User</h1>
<h2 id="pre-requisites">Pre-Requisites</h2>
<ul>
<li>You'll need the email address the user registered under. e.g. cpatti@mit.edu</li>
<li>You'll need the pre-requisites defined in <a href="../access_django_manage/">How To Access An MIT OL OpenEdX Django Admin manage.py</a>.</li>
</ul>
<h2 id="look-up-this-users-username">Look Up This User's username</h2>
<p>You'll need to have Django admin and superuser access to the product you're looking to retire users for.</p>
<p>Anyone who has the requisite access already can help. pdpinch@ and the Devops team are good folks to ask.</p>
<p>Next, you'll need to login to the admin web UI for the application we'll be working with. You can find that
URL from the <a href="https://github.mit.edu/odl-engineering/project-status/wiki/App-Links">Application Links Page</a>.</p>
<p>Find the product in question (e.g. mitxonline) and choose the LMS url for the environment you want (e.g. production) as a base.
Then add /admin on to the end. Ensure there's only one slash before /admin or things will go awry.</p>
<p>In our case, since we are looking to retire users from mitxonline, we'll use https://courses.mitxonline.mit.edu/admin</p>
<p>Find the Users link on that page, click it. Now type the email address into the search box and click Search.</p>
<p>This should yield the user's username. Copy that off into a safe place as we'll need it for the next section.</p>
<h2 id="get-yourself-connected">Get Yourself Connected</h2>
<p>First, follow the step by step instructions defined in <a href="../access_django_manage/">How To Access An MIT OL OpenEdX Django Admin manage.py</a>.</p>
<p>This will land you at a shell prompt of the OpenEdX worker for the product in question.</p>
<p>It should look something like:</p>
<p><code>ubuntu@ip-10-22-3-162:~$</code></p>
<h2 id="prepare-your-environment">Prepare Your Environment</h2>
<p>Next you'll need to prepare your UNIX shell's environment to be able to run the manage.py command.</p>
<p>Type: <code>sudo su - edxapp -s /bin/bash</code></p>
<p>Then type <code>source edxapp_env</code>.</p>
<p>At this point you should be ready to run the user retirement command.</p>
<h2 id="get-to-the-retiring-already">Get To The Retiring Already!</h2>
<h3 id="the-invocation">The Invocation</h3>
<p>Here's the command you'll use to retire a user.</p>
<p><code>python edx-platform/manage.py lms retire_user --user_email &lt;user email&gt; --username '&lt;username&gt;'</code></p>
<p>The single quotes around username are important in case there are any spaces in there. Otherwise the shell will mis-parse the command and throw an error.</p>
<p>So for example if I wanted to retire myself from mitxonline production, I'd use:</p>
<p><code>python edx-platform/manage.py lms retire_user --user_email cpatti@mit.edu --username 'ChrisPatti'</code></p>
<p>You should see a bunch of very voluminous output. Most of it is honestly garbage for our purposes. We'll focus on the bits we care about at the end:</p>
<p><code>2023-06-21 16:07:20,714 INFO 186970 [openedx.core.djangoapps.user_api.management.commands.retire_user] [user None] [ip None] retire_user.py:173 - User successfully moved to the retirement pipeline</code></p>
<p>The None here isn't anything to worry about. It's the system trying to prevent us from leaking PII (personally identifiable information) into the logs.</p>
<p>At this point if all went well, we're done with our edx worker shell prompt for now so we can log out. Always be super careful to not leave production shells open
unnecessarily. You'd be surprised how many systems have been brought down by someone not realizing they're in the wrong terminal :)</p>
<h3 id="priming-the-pump-well-pipeline-in-this-case">Priming The Pump (Well, Pipeline In This Case)</h3>
<p>Now that we've successfully staged our user for retirement, we need to tell the retirement pipeline to actually retire the user.</p>
<ul>
<li>Surf to the appropriate concourse URL for the entironment you're working with:</li>
<li><a href="https://cicd-ci.odl.mit.edu">CI</a></li>
<li><a href="https://cicd-qa.odl.mit.edu/">QA</a></li>
<li><a href="https://cicd.odl.mit.edu">Production</a></li>
</ul>
<p>and search for 'tubular'. You'll want the tubular pipeline in the group associated with whichever product you're working with. In our case, it'd be
  the <a href="https://cicd.odl.mit.edu/teams/mitxonline/pipelines/misc-cloud-tubular">misc-cloud-tubular pipeline in the mitxonline group</a>.
- Click the green + icon with a circle around it in the upper right of your screen. This will trigger a run of this pipeline.
- If all goes well, you should see each stage go green one by one. You can click on any stage to see more detail around what that stage is doing.
  You can see an example of a successful pipeline run <a href="https://cicd.odl.mit.edu/teams/mitxonline/pipelines/misc-cloud-tubular/jobs/deploy-tubular-world/builds/26">here</a></p>
<p>At this point, if the pipeline is green, congratulations are in order! This user had been retired!</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
